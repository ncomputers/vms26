<!-- Purpose: invite public template -->
<!DOCTYPE html>
<html>
<head>
  <title>Invite Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/flatly/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.1.1/build/css/intlTelInput.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.css">
</head>
<body class="vms-body">
<!-- ===== Section: Invite Form ===== -->
<div class="container mt-4">
  {% set company_logo = cfg.branding.company_logo_url or cfg.logo_url %}
  <div class="logo-wrapper mb-3 text-center">
    {% if company_logo %}
    <img src="{{ company_logo }}" alt="{{ cfg.branding.company_name }} logo" class="img-fluid" style="max-height:80px;">
    {% else %}
    <img src="/static/logo1.png" alt="Company logo" class="img-fluid" style="max-height:80px;">
    {% endif %}
  </div>
  <h2 class="mb-2 text-center">Welcome</h2>
  <p class="lead text-center">Fill in visitor details, choose or upload a photo, then submit.</p>
  <h1 class="mb-4">Visitor Invite Form</h1>
  <form id="pubForm" class="row g-3" enctype="multipart/form-data">
    <input type="hidden" name="id" value="{{ invite_id }}">
    <div class="col-12"><h3 class="py-2 mb-0">Visitor Info</h3></div>
    {% include 'partials/invite_fields.html' %}
    <div class="col-12"><h3 class="pt-3 mb-0">Visit Details</h3></div>
    <div class="col-12 col-md-4 mb-3">
      <label for="visit_time" class="form-label">Visit Date &amp; Time <span class="text-danger">*</span></label>
      <input id="visit_time" class="form-control" name="visit_time" placeholder="Visit Date &amp; Time" required>
    </div>
    <div class="col-12 col-md-4 mb-3">
      <label for="purpose" class="form-label">Purpose <span class="text-danger">*</span></label>
      <input id="purpose" class="form-control" name="purpose_text" required>
    </div>
    <div class="col-12"><h3 class="pt-3 mb-0">Photo Options</h3></div>
    <div class="col-12 col-md-6 mb-3" id="photoSection">
      <div class="mb-2 form-check">
        <input class="form-check-input" type="checkbox" id="noPhoto" name="no_photo">
        <label class="form-check-label" for="noPhoto">No photo available</label>
      </div>
      <div id="photoBlock">
        <video id="webcam" class="w-100 mb-2 d-none" autoplay playsinline></video>
        <canvas id="snapshot" class="w-100 mb-2 d-none"></canvas>
        <div class="mb-2" id="cameraControls">
          <button type="button" id="captureBtn" class="btn btn-secondary">Capture</button>
          <button type="button" id="retakeBtn" class="btn btn-secondary d-none">Retake</button>
        </div>
        <input type="hidden" id="captured" name="captured">
        <img id="photoPreview" class="img-fluid d-none mb-2" alt="Photo preview">
        <input type="file" id="photo" name="photo" accept="image/*" capture="environment" class="form-control">
      </div>
      <div class="mt-2 d-none" id="noPhotoReasonBlock">
        <label for="noPhotoReason" class="form-label">Reason for no photo (optional)</label>
        <input id="noPhotoReason" name="no_photo_reason" class="form-control">
      </div>
    </div>
  </form>
  <div id="msg" class="mt-3"></div>
  <div class="mt-4 small text-muted">
    An invite link is generated from your details and sent to your email after submission. Need host info? Visit our <a href="/help">help page</a>.
  </div>
</div>
<div class="fixed-bottom bg-light p-3 border-top">
  <button class="btn btn-primary w-100" type="submit" form="pubForm">Submit</button>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.1.1/build/js/intlTelInput.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.js"></script>
<script type="module" src="/static/js/webcam_capture.js"></script>
<script type="module" src="/static/js/invite_public.js"></script>

</body>
</html>
